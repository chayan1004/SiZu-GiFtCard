[Docs Home](https://developer.squareup.com/docs)

[Dev Essentials](https://developer.squareup.com/docs/development-essentials)

[Payments](https://developer.squareup.com/docs/payments-overview) [Commerce](https://developer.squareup.com/docs/commerce) [Customers](https://developer.squareup.com/docs/customers) [Staff](https://developer.squareup.com/docs/staff) [Merchants](https://developer.squareup.com/docs/merchant-details)

[Publish](https://developer.squareup.com/docs/app-marketplace)

[Release notes](https://developer.squareup.com/docs/release-notes)

## Docs

[Docs Home](https://developer.squareup.com/docs)

[Dev Essentials](https://developer.squareup.com/docs/development-essentials)

[Payments](https://developer.squareup.com/docs/payments-overview)

[Commerce](https://developer.squareup.com/docs/commerce)

[Customers](https://developer.squareup.com/docs/customers)

[Staff](https://developer.squareup.com/docs/staff)

[Merchants](https://developer.squareup.com/docs/merchant-details)

[Publish](https://developer.squareup.com/docs/app-marketplace)

[Release notes](https://developer.squareup.com/docs/release-notes)

[Overview](https://developer.squareup.com/docs/payments-overview)

[Technical Scenarios](https://developer.squareup.com/docs/payments/scenarios)

[Build a Tip Report](https://developer.squareup.com/docs/payments/scenarios/tip-reporting)

[Split an Online Payment](https://developer.squareup.com/docs/payments/scenarios/split-online-payment)

[Build a Sales Report](https://developer.squareup.com/docs/payments/scenarios/simple-sales-report)

[Payments](https://developer.squareup.com/docs/payments-refunds)

[Take Payments](https://developer.squareup.com/docs/payments-api/take-payments)

[Card Payments](https://developer.squareup.com/docs/payments-api/take-payments/card-payments)

[Delayed Capture](https://developer.squareup.com/docs/payments-api/take-payments/card-payments/delayed-capture)

[Partial Payments](https://developer.squareup.com/docs/payments-api/take-payments/card-payments/partial-payments-with-gift-cards)

[Statement Descriptions](https://developer.squareup.com/docs/payments-api/take-payments/card-payments/statement-descriptions)

[ACH Bank Transfer Payment](https://developer.squareup.com/docs/payments-api/take-payments/ach-payments)

[Afterpay and Clearpay Payments](https://developer.squareup.com/docs/payments-api/take-payments/afterpay-payments)

[Cash App Payments](https://developer.squareup.com/docs/payments-api/take-payments/cash-app-payments)

[Cash Payments](https://developer.squareup.com/docs/payments-api/take-payments/cash-payments)

[External Payments](https://developer.squareup.com/docs/payments-api/take-payments/external-payments)

[House Accounts](https://developer.squareup.com/docs/payments-api/take-payments/house-accounts)

[Collect Application Fees](https://developer.squareup.com/docs/payments-api/take-payments-and-collect-fees)

[Update Payment and Tip Amounts](https://developer.squareup.com/docs/payments-api/update-payments)

[Retrieve Payments](https://developer.squareup.com/docs/payments-api/retrieve-payments)

[Troubleshoot](https://developer.squareup.com/docs/payments-api/error-codes)

[Webhooks](https://developer.squareup.com/docs/payments-api/webhooks)

[Refunds](https://developer.squareup.com/docs/refunds-api/overview)

[Refund Payments](https://developer.squareup.com/docs/payments-api/refund-payments)

[Refund a Payment with an App Fee](https://developer.squareup.com/docs/payments-api/collect-fees/payment-with-app-fee-refund)

[Retrieve Refunds](https://developer.squareup.com/docs/refunds-api/retrieve-refunds)

[Process an Unlinked Refund](https://developer.squareup.com/docs/refunds-api/unlinked-refunds)

[Webhooks](https://developer.squareup.com/docs/refunds-api/webhooks)

[Disputes](https://developer.squareup.com/docs/disputes-api/overview)

[Process Disputes](https://developer.squareup.com/docs/disputes-api/process-disputes)

[Test in the Sandbox](https://developer.squareup.com/docs/disputes-api/sandbox-testing)

[Take Payments on Hardware](https://developer.squareup.com/docs/in-person-payment-options)

[Terminal API](https://developer.squareup.com/docs/terminal-api/overview)

[Quickstart](https://developer.squareup.com/docs/terminal-api/quickstart)

[Take Payments for Orders](https://developer.squareup.com/docs/terminal-api/take-payments-for-orders)

[Take One-Off Payments](https://developer.squareup.com/docs/terminal-api/square-terminal-payments)

Manage Terminals

[POS App Pairing](https://developer.squareup.com/docs/terminal-api/pos-integration)

[Monitor Square Terminals](https://developer.squareup.com/docs/terminal-api/terminal-device-monitoring)

[Check Device Information](https://developer.squareup.com/docs/terminal-api/advanced-features/check-device-information)

Customize Terminal Checkouts

[Add Payment and Checkout Features](https://developer.squareup.com/docs/terminal-api/additional-payment-checkout-features)

[Save Card on File](https://developer.squareup.com/docs/terminal-api/advanced-features/save-card-on-file)

[Print or Issue Receipts](https://developer.squareup.com/docs/terminal-api/advanced-features/issue-receipts)

[Customize the Idle Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/customize-idle-screen)

[Custom Screen Workflows](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows)

[Confirmation Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/confirmation)

[Signature Capture Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/signature)

[Data Collection Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/data-collection)

[Menu Selection List Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/menu-select)

[QR Code Screen](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/qr-code-display)

[Link and Dismiss Actions](https://developer.squareup.com/docs/terminal-api/advanced-features/custom-workflows/link-and-dismiss-actions)

[Manage Terminal Actions](https://developer.squareup.com/docs/terminal-api/advanced-features)

[Mobile Payments SDK](https://developer.squareup.com/docs/mobile-payments-sdk)

[Build on Android](https://developer.squareup.com/docs/mobile-payments-sdk/android)

[Authorize the Mobile Payments SDK](https://developer.squareup.com/docs/mobile-payments-sdk/android/configure-authorize)

[Pair and Manage Card Readers](https://developer.squareup.com/docs/mobile-payments-sdk/android/pair-manage-readers)

[Take a Payment](https://developer.squareup.com/docs/mobile-payments-sdk/android/take-payments)

[Tap to Pay on Android](https://developer.squareup.com/docs/mobile-payments-sdk/android/tap-to-pay)

[Offline Payments](https://developer.squareup.com/docs/mobile-payments-sdk/android/offline-payments)

[Handling Errors](https://developer.squareup.com/docs/mobile-payments-sdk/android/handling-errors)

[Build on iOS](https://developer.squareup.com/docs/mobile-payments-sdk/ios)

[Authorize the Mobile Payments SDK](https://developer.squareup.com/docs/mobile-payments-sdk/ios/configure-authorize)

[Pair and Manage Card Readers](https://developer.squareup.com/docs/mobile-payments-sdk/ios/pair-manage-readers)

[Take a Payment](https://developer.squareup.com/docs/mobile-payments-sdk/ios/take-payments)

[Tap to Pay on iPhone](https://developer.squareup.com/docs/mobile-payments-sdk/ios/tap-to-pay)

[Offline Payments](https://developer.squareup.com/docs/mobile-payments-sdk/ios/offline-payments)

[Configure for Square Stand or Square Kiosk](https://developer.squareup.com/docs/mobile-payments-sdk/ios/square-stand)

[Handling Errors](https://developer.squareup.com/docs/mobile-payments-sdk/ios/handling-errors)

[Migrate from Reader SDK](https://developer.squareup.com/docs/mobile-payments-sdk/migrate)

[React Native Plugin](https://developer.squareup.com/docs/mobile-payments-sdk/react-native)

[Flutter Plugin](https://developer.squareup.com/docs/mobile-payments-sdk/flutter)

[Reader SDK](https://developer.squareup.com/docs/reader-sdk/what-it-does)

[Migrate to Mobile Payments SDK](https://developer.squareup.com/docs/mobile-payments-sdk/migrate)

[Quickstart](https://developer.squareup.com/docs/reader-sdk/quick-start/start)

[Get Credentials](https://developer.squareup.com/docs/reader-sdk/quick-start/step-1)

[Configure the Sample Application](https://developer.squareup.com/docs/reader-sdk/quick-start/step-2)

[Take a Cash Payment](https://developer.squareup.com/docs/reader-sdk/quick-start/step-3)

[Customize the Checkout Amount](https://developer.squareup.com/docs/reader-sdk/quick-start/step-4)

[Take a Credit Card Payment](https://developer.squareup.com/docs/reader-sdk/quick-start/step-5)

[How It Works](https://developer.squareup.com/docs/reader-sdk/how-it-works)

[Build on Android](https://developer.squareup.com/docs/reader-sdk/build-on-android)

[Build on iOS](https://developer.squareup.com/docs/reader-sdk/build-on-ios)

[Connect a Contactless Reader](https://developer.squareup.com/docs/reader-sdk/cookbook/contactless-reader)

[Charge a Card on File](https://developer.squareup.com/docs/reader-sdk/cookbook/charge-cards-on-file)

[Save a Card on File](https://developer.squareup.com/docs/reader-sdk/cookbook/save-cards-on-file)

[Configure on iOS for Square Stand](https://developer.squareup.com/docs/reader-sdk/cookbook/square-stand)

[Deauthorize Reader SDK](https://developer.squareup.com/docs/reader-sdk/cookbook/deauthorize-reader-sdk)

[Capture a Transaction](https://developer.squareup.com/docs/reader-sdk/cookbook/capture-a-transaction)

[Delay the Capture of Payments](https://developer.squareup.com/docs/reader-sdk/cookbook/delay-capture-of-payment)

[Configure APK Splits](https://developer.squareup.com/docs/reader-sdk/cookbook/configure-apk-splits)

[Update to New Reader SDK Version](https://developer.squareup.com/docs/reader-sdk/upgrade-reader-sdk)

[Flutter Plugin](https://developer.squareup.com/docs/reader-sdk/flutter)

[React Native Plugin](https://developer.squareup.com/docs/reader-sdk/react-native)

[Point of Sale API](https://developer.squareup.com/docs/pos-api/what-it-does)

[How It Works](https://developer.squareup.com/docs/pos-api/how-it-works)

[Build on Android](https://developer.squareup.com/docs/pos-api/build-on-android)

[Build on iOS](https://developer.squareup.com/docs/pos-api/build-on-ios)

[Build on Mobile Web](https://developer.squareup.com/docs/pos-api/build-mobile-web)

[Find Your Android Fingerprint](https://developer.squareup.com/docs/pos-api/cookbook/find-your-android-fingerprint)

[Use the API in Offline Mode](https://developer.squareup.com/docs/pos-api/cookbook/offline-mode)

[Add an Alert Dialog Helper Class](https://developer.squareup.com/docs/pos-api/cookbook/alert-dialog-helper)

[Accept E-Money Payments](https://developer.squareup.com/docs/pos-api/cookbook/electronic-payments)

[Accept PayPay Payments](https://developer.squareup.com/docs/pos-api/qr-code-payments-paypay)

[Mobile Web Technical Reference](https://developer.squareup.com/docs/pos-api/web-technical-reference)

[Payments API Integration](https://developer.squareup.com/docs/pos-api/payments-integration)

[Take Payments Online](https://developer.squareup.com/docs/online-payment-options)

[Web Payments SDK](https://developer.squareup.com/docs/web-payments/overview)

[Quickstart](https://developer.squareup.com/docs/web-payments/quickstart)

[Set Up the Web Client App](https://developer.squareup.com/docs/web-payments/quickstart/set-up-web-client-app)

[Add the SDK to the Web Client](https://developer.squareup.com/docs/web-payments/quickstart/add-sdk-to-web-client)

[Deploy the Application](https://developer.squareup.com/docs/web-payments/quickstart/deploy-app)

[Take a Card Payment](https://developer.squareup.com/docs/web-payments/take-card-payment)

[Integrate Digital Wallets](https://developer.squareup.com/docs/web-payments/digital-wallets)

[Apple Pay](https://developer.squareup.com/docs/web-payments/apple-pay)

[Google Pay](https://developer.squareup.com/docs/web-payments/google-pay)

[Digital Wallet Payment Requests](https://developer.squareup.com/docs/web-payments/payment-requests)

[ACH Bank Transfer](https://developer.squareup.com/docs/web-payments/add-ach)

[Afterpay](https://developer.squareup.com/docs/web-payments/add-afterpay)

[Cash App Pay](https://developer.squareup.com/docs/web-payments/add-cash-app-pay)

[Square Gift Card Payments](https://developer.squareup.com/docs/web-payments/gift-cards-intro)

[Take a Gift Card Payment](https://developer.squareup.com/docs/web-payments/gift-card)

[Take Partial Payments](https://developer.squareup.com/docs/web-payments/gift-card-walkthrough)

[Customize the Card Entry Form](https://developer.squareup.com/docs/web-payments/customize-styles)

[Charge and Store Cards](https://developer.squareup.com/docs/web-payments/charge-and-store-cards)

[Add a Content Security Policy](https://developer.squareup.com/docs/web-payments/content-security-policy)

[In-App Payments SDK](https://developer.squareup.com/docs/in-app-payments-sdk/what-it-does)

[Quickstart](https://developer.squareup.com/docs/in-app-payments-sdk/quick-start)

[Set up the Client](https://developer.squareup.com/docs/in-app-payments-sdk/quick-start/generate-token)

[Deploy the Server](https://developer.squareup.com/docs/in-app-payments-sdk/quick-start/deploy-server-backend)

[Install the SDK](https://developer.squareup.com/docs/in-app-payments-sdk/installation)

[Build on Android](https://developer.squareup.com/docs/in-app-payments-sdk/build-on-android)

[Build on iOS](https://developer.squareup.com/docs/in-app-payments-sdk/build-on-ios)

[Integrate Digital Wallets](https://developer.squareup.com/docs/in-app-payments-sdk/add-digital-wallets)

[Google Pay](https://developer.squareup.com/docs/in-app-payments-sdk/add-digital-wallets/google-pay)

[Apple Pay](https://developer.squareup.com/docs/in-app-payments-sdk/add-digital-wallets/apple-pay)

[Localize an Application](https://developer.squareup.com/docs/in-app-payments/localize-ios)

[Gift Card Payments](https://developer.squareup.com/docs/in-app-payments-sdk/cookbook/giftcards)

[Flutter Plugin](https://developer.squareup.com/docs/in-app-payments-sdk/flutter)

[React Native Plugin](https://developer.squareup.com/docs/in-app-payments-sdk/react-native)

[Customize the Payment Entry Form](https://developer.squareup.com/docs/in-app-payments-sdk/cookbook/customize-payment-form)

[Connect to a Backend Service](https://developer.squareup.com/docs/in-app-payments-sdk/cookbook/connect-to-a-backend-service)

[Remove the Postal Code Requirement](https://developer.squareup.com/docs/in-app-payments-sdk/cookbook/disable-postal-code)

[Troubleshoot](https://developer.squareup.com/docs/in-app-payments-sdk/troubleshooting)

[How It Works](https://developer.squareup.com/docs/in-app-payments-sdk/how-it-works)

[Strong Customer Authentication](https://developer.squareup.com/docs/sca-overview-iap)

[Verify a Buyer](https://developer.squareup.com/docs/in-app-payments-sdk/verify-buyer)

[Checkout API](https://developer.squareup.com/docs/checkout-api)

[Quick Pay Checkout](https://developer.squareup.com/docs/checkout-api/quick-pay-checkout)

[Square Order Checkout](https://developer.squareup.com/docs/checkout-api/square-order-checkout)

[Subscription Plan Checkout](https://developer.squareup.com/docs/checkout-api/subscription-plan-checkout)

[Checkout Settings](https://developer.squareup.com/docs/checkout-api/checkout-settings)

[Checkout Configurations](https://developer.squareup.com/docs/checkout-api/optional-checkout-configurations)

[Manage Checkout](https://developer.squareup.com/docs/checkout-api/manage-checkout)

[Guidelines and Limitations](https://developer.squareup.com/docs/checkout-api/guidelines-and-limitations)

[Subscriptions API](https://developer.squareup.com/docs/subscriptions/overview)

[Subscription Plans and Variations](https://developer.squareup.com/docs/subscriptions-api/plans-and-variations)

[Manage Subscriptions](https://developer.squareup.com/docs/subscriptions-api/manage-subscriptions)

[Subscription Actions and Events](https://developer.squareup.com/docs/subscriptions-api/actions-events)

[Pause, Resume, or Cancel Subscriptions](https://developer.squareup.com/docs/subscriptions-api/pause-resume-cancel-subscriptions)

[Subscription Billing and Invoices](https://developer.squareup.com/docs/subscriptions-api/subscription-billing)

[Swap Subscription Plan Variations](https://developer.squareup.com/docs/subscriptions-api/swap-plan-variations)

[Invoices API](https://developer.squareup.com/docs/invoices-api/overview)

[Create and Publish Invoices](https://developer.squareup.com/docs/invoices-api/create-publish-invoices)

[Retrieve, List, or Search Invoices](https://developer.squareup.com/docs/invoices-api/retrieve-list-search-invoices)

[Create or Delete Invoice Attachments](https://developer.squareup.com/docs/invoices-api/attachments)

[Update Invoices](https://developer.squareup.com/docs/invoices-api/update-invoices)

[Cancel or Delete Invoices](https://developer.squareup.com/docs/invoices-api/cancel-delete-invoices)

[Pay or Refund Invoices](https://developer.squareup.com/docs/invoices-api/pay-refund-invoices)

[Walkthrough: Create and Publish Invoices](https://developer.squareup.com/docs/invoices-api/walkthrough)

[Cards](https://developer.squareup.com/docs/cards-api/overview)

[Manage Cards](https://developer.squareup.com/docs/cards-api/manage-cards)

[Create a Card on File from Payment ID](https://developer.squareup.com/docs/cards-api/walkthrough/card-from-payment-id)

[Create a Card on File and Make a Payment](https://developer.squareup.com/docs/cards-api/walkthrough-seller-card)

[Create a Shared Card on File and Make a Payment](https://developer.squareup.com/docs/cards-api/walkthrough-shared-card)

[Manage Card Declines](https://developer.squareup.com/docs/cards-api/manage-card-on-file-declines)

[Payouts](https://developer.squareup.com/docs/payouts-api/overview)

[List Payouts](https://developer.squareup.com/docs/payouts-api/list-payouts)

[Get Payout](https://developer.squareup.com/docs/payouts-api/get-payout)

[List Payout Entries](https://developer.squareup.com/docs/payouts-api/list-payout-entries)

[Bank Accounts](https://developer.squareup.com/docs/bank-accounts-api)

[Mobile Authorization](https://developer.squareup.com/docs/mobile-authz/what-it-does)

[How It Works](https://developer.squareup.com/docs/mobile-authz/how-it-works)

[Build with Mobile Authorization](https://developer.squareup.com/docs/mobile-authz/build-with-mobile-authz)

[Get Authorization Code on Command Line](https://developer.squareup.com/docs/mobile-authz/cookbook/mobile-code-with-curl)

[Payment Methods by Country](https://developer.squareup.com/docs/payment-card-support-by-country)

[Payments Pricing](https://developer.squareup.com/docs/payments-pricing)

[Strong Customer Authentication](https://developer.squareup.com/docs/sca-overview)

[Payment Minimums](https://developer.squareup.com/docs/payment-minimums)

[Documentation homepage](https://developer.squareup.com/docs)

/

[Payments](https://developer.squareup.com/docs/payments-overview)

/

[Take Payments Online](https://developer.squareup.com/docs/online-payment-options)

/

[Web Payments SDK](https://developer.squareup.com/docs/web-payments/overview)

# Add a Content Security Policy

Learn how to implement a Content Security Policy with vendor scripts in your Web Payments SDK integration.

[anchor link for overview](https://developer.squareup.com/docs/web-payments/content-security-policy#overview)

Link to section

## Overview

A Content Security Policy (CSP) is a critical security feature that helps protect your Web Payments SDK integration from various attacks, specifically cross-site scripting (XSS) attacks. To comply with the latest PCI DDS security requirements, your application must provide a CSP vendor script for a supported payment method, so that the Web Payments SDK can securely process payments through the payment method, and enable the CSP to protect your application from external scripting attacks.

[anchor link for what-csp-provides](https://developer.squareup.com/docs/web-payments/content-security-policy#what-csp-provides)

Link to section

## What CSP provides

CSP provides several key security benefits:

- Controls which resources (scripts, styles, images) can load
- Specifies allowed origins for content
- Prevents malicious script injection
- Manages secure communication with payment endpoints

[anchor link for requirements-and-limitations](https://developer.squareup.com/docs/web-payments/content-security-policy#requirements-and-limitations)

Link to section

## Requirements and limitations

- Web Payments SDK installed and integrate with an application
- Access to modify your application's headers
- An HTTPS-enabled environment for development

[anchor link for set-up-csp](https://developer.squareup.com/docs/web-payments/content-security-policy#set-up-csp)

Link to section

## Set up CSP

If your application deploys a Content Security Policy (CSP) with the Web Payments SDK, you must enable the following CSP directives to add an additional security layer.

1. Modify the headers.

In `index.html`, add the CSP meta tag or header to your application:

For Sandbox Environment:

















Copy







Expand











```

<meta http-equiv="Content-Security-Policy" content="
       default-src 'self';
       script-src 'self' https://sandbox.web.squarecdn.com;
       frame-src 'self' https://sandbox.web.squarecdn.com;
       connect-src 'self' https://sandbox.web.squarecdn.com;
       style-src 'self' 'unsafe-inline';">
```











For Production:

















Copy







Expand











```

<meta http-equiv="Content-Security-Policy" content="
       default-src 'self';
       script-src 'self' https://web.squarecdn.com;
       frame-src 'self' https://web.squarecdn.com;
       connect-src 'self' https://web.squarecdn.com;
       style-src 'self' 'unsafe-inline';">
```

2. Add the vendor scripts.

Include the necessary payment scripts in your HTML:








Square









Cash App Pay





Afterpay





ACH





Google Pay


























Copy







Expand













```

<!-- Square Sandbox -->
<meta http-equiv="Content-Security-Policy" content="
       frame-src https://sandbox.web.squarecdn.com;
       connect-src https://pci-connect.squareupsandbox.com https://o160250.ingest.sentry.io;
       script-src https://sandbox.web.squarecdn.com;
       style-src https://sandbox.web.squarecdn.com;
       font-src https://square-fonts-production-f.squarecdn.com https://d1g145x70srn7h.cloudfront.net">

<!-- Square Production -->
<meta http-equiv="Content-Security-Policy" content="
       frame-src https://web.squarecdn.com;
       connect-src https://pci-connect.squareup.com https://o160250.ingest.sentry.io;
       script-src https://web.squarecdn.com;
       style-src https://web.squarecdn.com;
       font-src https://square-fonts-production-f.squarecdn.com https://d1g145x70srn7h.cloudfront.net">
```

3. Implement error handling in the application.

Add error handling for the following script loading failures in the application:

















Copy







Expand











```

// Monitor script loading
window.addEventListener('error', function(e) {
       if (e.target.src && e.target.src.includes('square.js')) {
           console.error('Square script failed to load:', e);
           handleScriptLoadError();
       }
});

function handleScriptLoadError() {
       // Implement your fallback logic
       const paymentForm = document.getElementById('payment-form');
       if (paymentForm) {
        paymentForm.innerHTML = 'Payment temporarily unavailable. Please try again later.';
       }

       // Notify your error monitoring service
       notifyErrorService('Square script load failure');
}
```

4. Verify the CSP implementation.

1. Check the console with a web browser:

      - Look for CSP violation messages.
      - Verify script loading success.
2. Test a payment flow:

















      Copy







      Expand











      ```

      async function testPaymentFlow() {
          try {
              const payments = Square.payments(appId, locationId);
              const card = await payments.card();
              await card.attach('#card-container');
              console.log('Payment flow initialized successfully');
          } catch (e) {
           console.error('Payment flow test failed:', e);
          }
      }
      ```

3. Validate in different environments:

      - Test in sandbox environment first.
      - Verify in staging (if applicable).
      - Confirm in production.

[anchor link for common-issues-and-solutions](https://developer.squareup.com/docs/web-payments/content-security-policy#common-issues-and-solutions)

Link to section

## Common issues and solutions

Script loading failures:

- Verify CSP directives match script sources.
- Check for network connectivity.
- Confirm that the script URLs are correct.

CSP violations:

- Review browser console for specific violation messages.
- Update CSP to include missing sources.
- Verify all resource domains are included.

Integration conflicts:

- Check for conflicts with other security headers.
- Verify compatibility with other third-party scripts.
- Test with all payment methods.

[anchor link for best-practices](https://developer.squareup.com/docs/web-payments/content-security-policy#best-practices)

Link to section

## Best practices

Security:

- Use specific source URLs rather than wildcards
- Minimize use of 'unsafe-inline' and 'unsafe-eval'
- Regularly review and update CSP rules

Performance:

- Load scripts asynchronously when possible
- Implement proper error handling
- Monitor script loading performance

Maintenance:

- Document all CSP modifications
- Keep track of vendor script versions
- Regular testing of all payment flows

[anchor link for additional-resources](https://developer.squareup.com/docs/web-payments/content-security-policy#additional-resources)

Link to section

## Additional resources

- [Mozilla - Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
- [CSP Evaluator tool](https://csp-evaluator.withgoogle.com/)

##### On this page

[Overview](https://developer.squareup.com/docs/web-payments/content-security-policy#overview) [What CSP provides](https://developer.squareup.com/docs/web-payments/content-security-policy#what-csp-provides) [Requirements and limitations](https://developer.squareup.com/docs/web-payments/content-security-policy#requirements-and-limitations) [Set up CSP](https://developer.squareup.com/docs/web-payments/content-security-policy#set-up-csp) [Common issues and solutions](https://developer.squareup.com/docs/web-payments/content-security-policy#common-issues-and-solutions) [Best practices](https://developer.squareup.com/docs/web-payments/content-security-policy#best-practices) [Additional resources](https://developer.squareup.com/docs/web-payments/content-security-policy#additional-resources)

Thanks for the feedback. For more help, check out our support resources.

[Developer Support](https://squareup.com/help/contact?panel=BF53A9C8EF68) [Developer Forums](https://developer.squareup.com/forums)

There was an error submitting feedback. Try again later.

[Developer Support](https://squareup.com/help/contact?panel=BF53A9C8EF68) [Developer Forums](https://developer.squareup.com/forums)

### Was this page helpful?

Yes

No

If you need more assistance, contact [Developer and App Marketplace Support](https://squareup.com/help/contact?panel=BF53A9C8EF68) or ask for help in the [Developer Forums](https://developer.squareup.com/forums).

![Company Logo](https://cdn.cookielaw.org/logos/aa498dad-1691-4c3b-894a-906c990be323/eab8b6ff-57d6-438a-a7e5-c58dd370ce73/000d8b20-8c3d-4f4f-a0da-5b515f8f20d2/Square_combinationmark_black.png)

## Cookie preferences

When you interact with our mobile applications or online services, we and third parties obtain certain information by using automated technologies, such as cookies, web beacons, and other technologies described in our Cookie Policy. This information might be about you, your preferences, or your device. You may opt out of certain categories of third party cookies, other than those that are strictly necessary to provide you with our Services. Expand the different categories for more information and to make your choices.

To effectuate your right to opt-out of the sharing of your personal information for purposes of targeted advertising, please toggle off "retargeting or advertising technology" cookies below.


[More information](https://squareup.com/gb/en/legal/general/cookie) [Privacy Notice](https://squareup.com/us/en/legal/general/privacy)

Accept all cookies

### Manage cookie preferences

#### Strictly necessary technology

Always Active

These technologies are necessary for us to provide you with the Services.

#### Performance and analytical technology

Performance and analytical technology

This information is used to make sure our Services can cope with the volume of users, to help us correct errors in the Services and to measure use across our Services. These technologies help us understand if you have used our Services before so we can identify the number of unique users we receive. They also help us understand how long you spend using our Services and from where you have accessed the Services, so that we can improve the Services and learn about the most popular aspects of the Services.

#### Functionality technology

Functionality technology

These technologies enable us to remember you have used our Services before, preferences you may have indicated, and information you have provided to us to give you a customized experience. For example, this would include ensuring the continuity of your registration process.

#### Retargeting or advertising technology

Retargeting or advertising technology

We use third parties, for example, Google Analytics, to analyze statistical information from users of the Site. We might be able to associate such information with other information which we collect from you once we receive it from a third party. For example, these technologies may collect information about whether you clicked an ad to download our application.

Back Button

### Cookie List

Search Icon

Filter Icon

Clear

checkbox labellabel

ApplyCancel

ConsentLeg.Interest

checkbox labellabel

checkbox labellabel

checkbox labellabel

Confirm my choices

[![Powered by Onetrust](https://cdn.cookielaw.org/logos/static/powered_by_logo.svg)](https://www.onetrust.com/products/cookie-consent/)